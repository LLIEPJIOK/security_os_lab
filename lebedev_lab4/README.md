# Отчет по лабораторной работе №4

_Автор: Лебедев Денис_

## Основное задание

Решение основного задания осуществлялось по следующим шагам:

1. Изменение расширения файла `lab_app.apk` на `lab_app.zip`.
2. Извлечение из файла `lab_app.zip` файла `classes.dex`.
3. Открытие файла `classes.dex` в `bytecode viewer`.
4. Поиск алгоритма шифрования в коде приложения:

Поиск осуществлялся по слову `Enc`. Сразу нашёлся class `FilesEncryptor`, который вероятно отвечает за шифрование файлов.
Открыв его, можно увидеть, что используется алгоритм шифрования AES:
![FilesEncryptor](images/files_encryptor.png)

Класс `AesCrypt` ищется без труда и реализует алгоритм шифрования AES. Скопировав этот файл, заменив `this.cipher = Cipher.getInstance("AES/CBC/PKCS7Padding");` на `this.cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");` _(так как в Java PKCS7Padding и PKCS5Padding эквивалентны, но PKCS7Padding не поддерживается в стандартной библиотеке Java)_ и добавив секретный ключ `jndlasf074hr` из `FilesEncryptor` получили класс [decryptor](decryptor) для расшифровки файлов.

Запустив его с помощью команды `make test`, получим расшифрованную картинку:
![test_image](data/test.jpg)

_Note: антивирус на компьютере может удалять исследуемую программу, поэтому может быть необходимо отключить его перед выполнением задания._
